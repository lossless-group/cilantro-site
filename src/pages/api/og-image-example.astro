---
/**
 * Example page showing how to use dynamic OG images
 *
 * This file demonstrates the various ways to integrate
 * the OG image generation system into your pages.
 */

import BaseLayout from '../../layouts/BaseLayout.astro';
import { buildOgImageUrl, buildOgImageMeta } from '../../utils/og-image';

// Example: Static OG image
const staticOgImage = buildOgImageUrl({
  template: 'social-share-banner',
  title: 'The missing Context Layer',
  highlight: 'missing Context Layer',
  subtitle: 'Document AI Platform'
});

// Example: Dynamic content (could come from CMS, frontmatter, etc.)
const pageTitle = 'Dynamic OG Image Example';
const dynamicOgImage = buildOgImageUrl({
  template: 'social-share-banner',
  title: pageTitle,
  subtitle: 'Learn how to generate images on-the-fly'
});

// Example: Using the meta helper
const ogMeta = buildOgImageMeta({
  template: 'social-share-banner',
  title: 'Automated Social Shares',
  highlight: 'Automated',
  subtitle: 'Marketing Team'
});
---

<BaseLayout title="OG Image Generation Example">
  <div class="container mx-auto px-6 py-16 max-w-4xl">
    <h1 class="text-4xl font-bold mb-8">Dynamic OG Image Generation</h1>

    <div class="prose prose-lg">
      <p class="lead">
        This page demonstrates how to use the dynamic Open Graph image generation system.
        View the page source to see how it's implemented.
      </p>

      <section class="my-12">
        <h2>Example 1: Static Image</h2>
        <div class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
          <img src={staticOgImage} alt="Static OG Image Example" class="w-full rounded shadow-lg" />
        </div>
        <details class="mt-4">
          <summary class="cursor-pointer font-semibold">View Code</summary>
          <pre class="bg-gray-900 text-gray-100 p-4 rounded mt-2 overflow-x-auto"><code>{`import { buildOgImageUrl } from '@/utils/og-image';

const staticOgImage = buildOgImageUrl({
  template: 'social-share-banner',
  title: 'The missing Context Layer',
  highlight: 'missing Context Layer',
  subtitle: 'Document AI Platform'
});

<meta property="og:image" content={staticOgImage} />`}</code></pre>
        </details>
      </section>

      <section class="my-12">
        <h2>Example 2: Dynamic Content</h2>
        <div class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
          <img src={dynamicOgImage} alt="Dynamic OG Image Example" class="w-full rounded shadow-lg" />
        </div>
        <details class="mt-4">
          <summary class="cursor-pointer font-semibold">View Code</summary>
          <pre class="bg-gray-900 text-gray-100 p-4 rounded mt-2 overflow-x-auto"><code>{`// Content could come from CMS, frontmatter, etc.
const pageTitle = 'Dynamic OG Image Example';

const dynamicOgImage = buildOgImageUrl({
  template: 'social-share-banner',
  title: pageTitle,
  subtitle: 'Learn how to generate images on-the-fly'
});`}</code></pre>
        </details>
      </section>

      <section class="my-12">
        <h2>Example 3: Using Meta Helper</h2>
        <p>The meta helper generates all required meta tags:</p>
        <details class="mt-4">
          <summary class="cursor-pointer font-semibold">View Code</summary>
          <pre class="bg-gray-900 text-gray-100 p-4 rounded mt-2 overflow-x-auto"><code>{`import { buildOgImageMeta } from '@/utils/og-image';

const ogMeta = buildOgImageMeta({
  template: 'social-share-banner',
  title: 'Automated Social Shares',
  highlight: 'Automated',
  subtitle: 'Marketing Team'
});

// In your <head>:
{Object.entries(ogMeta).map(([property, content]) => (
  <meta property={property} content={content} />
))}`}</code></pre>
        </details>
      </section>

      <section class="my-12 bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 p-6">
        <h3 class="text-xl font-bold mb-2">ðŸ’¡ Pro Tips</h3>
        <ul class="space-y-2">
          <li><strong>Preview templates:</strong> Visit <code>/share-images/social-share-banner.html</code></li>
          <li><strong>Test parameters:</strong> Add <code>?title=Test&subtitle=Demo</code> to template URLs</li>
          <li><strong>View documentation:</strong> Check <code>/share-images/README.md</code></li>
          <li><strong>Cache control:</strong> Images are automatically cached; delete <code>/public/generated-og/</code> to regenerate</li>
        </ul>
      </section>

      <section class="my-12">
        <h2>API Endpoint</h2>
        <p>The image generation API is available at:</p>
        <pre class="bg-gray-900 text-gray-100 p-4 rounded"><code>/api/og-image?template=social-share-banner&title=Your+Title&subtitle=Your+Subtitle</code></pre>
        <p class="mt-4">
          <a href="/api/og-image?template=social-share-banner&title=Hello+World&highlight=Hello&subtitle=Test+Image"
             class="text-blue-600 hover:underline"
             target="_blank">
            â†’ Try it now
          </a>
        </p>
      </section>

      <section class="my-12">
        <h2>Creating Custom Templates</h2>
        <ol class="space-y-3">
          <li>
            <strong>Create HTML file:</strong> Add your template to <code>/public/share-images/</code>
          </li>
          <li>
            <strong>Add JavaScript:</strong> Read URL parameters and update content dynamically
          </li>
          <li>
            <strong>Test in browser:</strong> Open <code>/share-images/your-template.html?param=value</code>
          </li>
          <li>
            <strong>Generate images:</strong> Use <code>/api/og-image?template=your-template&param=value</code>
          </li>
        </ol>
        <p class="mt-4">
          See <a href="/share-images/README.md" class="text-blue-600 hover:underline" target="_blank">full documentation</a> for details.
        </p>
      </section>
    </div>
  </div>
</BaseLayout>

<style>
  code {
    background: rgba(0, 0, 0, 0.05);
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-size: 0.9em;
  }

  pre code {
    background: transparent;
    padding: 0;
  }

  summary:hover {
    color: #3FE0DE;
  }
</style>
